(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"EbT/":function(t,e,n){"use strict";n.r(e);var o=n("CcnG"),i=function(){},r=function(t){return t[t.enter=13]="enter",t[t.left=37]="left",t[t.up=38]="up",t[t.right=39]="right",t[t.down=40]="down",t}(r||(r={}));function s(t){return Boolean(r[t])}var a=function(){function t(){this.keys={}}return t.prototype.setKey=function(t,e){return s(t)&&(this.keys[r[t]]=e),this},t.prototype.reset=function(){return this.keys={},this},t}(),c=function(){function t(t){this.control=t,this.kcKeypress=new o.m}return t.prototype.onKeyboardPress=function(t){s(t.keyCode)&&(t.preventDefault(),this.kcKeypress.emit()),this.control.setKey(t.keyCode,"keyup"===t.type?0:1)},t.prototype.onTouch=function(t){var e=t.changedTouches.item(0).clientX;e>window.innerWidth/2&&(t.keyCode=r.right),e<window.innerWidth/2&&(t.keyCode=r.left),this.onKeyboardPress(t)},t.prototype.controlTouchEnd=function(){this.control.reset()},t}(),u=n("Ip0R"),l=n("AytR"),h=n("Z6j7");function p(t){return parseInt(t,10)||0}var f=function(){function t(){this.collection={},this.promises=[]}return t.prototype.add=function(t,e){var n=this,o=new Image,i=new Promise(function(i,r){o.onerror=function(){return r()},o.onload=function(){n.collection[t]=o,i()},o.src=e});return this.promises.push(i),this},t.prototype.get=function(t){if(!this.collection[t])throw new Error("The image "+t+" is not found in collection");return this.collection[t]},t.prototype.ready=function(){return t=this,void 0,n=function(){return function(t,e){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[0,i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,function(t){switch(t.label){case 0:return[4,Promise.all(this.promises)];case 1:return t.sent(),this.promises=[],[2]}})},new((e=void 0)||(e=Promise))(function(o,i){function r(t){try{a(n.next(t))}catch(t){i(t)}}function s(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new e(function(e){e(t.value)}).then(r,s)}a((n=n.apply(t,[])).next())});var t,e,n},t}(),d=n("mrSG"),m=[255,255,255],g=4,y=function(t){function e(e){var n=t.call(this,e)||this;n.animationFrequency=100,n.destroyable=!1,n.intermediate=!1,n.spritesCount=1,n.colorPoints=[],n.someColorPointsOffset=0,n.someColorPointsStep=0,n.spritePosFromEnd=!1,Object.assign(n,e),n.image=e.image;var o=n.spritesCount,i=n.image.naturalWidth,r=n.image.naturalHeight/o;if(n.points=[[0,0],[i,r]],n.spritePos=Object(h.a)(0,o-1),n.destroyable){var s=n.ctx;s.fillStyle="#fff",s.fillRect(0,0,i,r),n.draw();for(var a=0;a<i;a++)for(var c=0;c<r;c++)if(n._checkColor(a,c,!0)){for(c=r-1;c>=0&&!n._checkColor(a,c);c--);break}for(c=0;c<r;c++)for(a=0;a<i;a++)if(n._checkColor(a,c)){for(a=i-1;a>=0&&!n._checkColor(a,c);a--);break}s.clearRect(0,0,s.canvas.width,s.canvas.height),n.someColorPointsStep=Math.floor(n.colorPoints.length/g),n.someColorPointsOffset=0}return o>1&&(n.intermediate?setInterval(function(){n.spritePos+=n.spritePosFromEnd?-1:1,n.spritePos%o==0&&(n.spritePosFromEnd=!n.spritePosFromEnd,n.spritePosFromEnd&&n.spritePos--)},n.animationFrequency):setInterval(function(){n.spritePos++,n.spritePos%=o},n.animationFrequency)),n}return Object(d.b)(e,t),e.prototype.draw=function(){var t=[this.image.naturalWidth,this.image.naturalHeight/this.spritesCount];return this.ctx.drawImage(this.image,0,t[1]*this.spritePos,t[0],t[1],this.points[0][0],this.points[0][1],t[0],t[1]),this},Object.defineProperty(e.prototype,"isDestroyed",{get:function(){var t=this;return this.someColorPoints.some(function(e){var n=e[0],o=e[1],i=e.slice(2),r=t.points[0],s=t.ctx.getImageData(n+r[0],o+r[1],1,1).data;return i.some(function(t,e){return s[e]!==t})})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"someColorPoints",{get:function(){for(var t=this.colorPoints,e=[],n=this.someColorPointsOffset;n<t.length;n+=this.someColorPointsStep)e.push(t[n]);return this.someColorPointsOffset++,this.someColorPointsOffset%=this.someColorPointsStep,e},enumerable:!0,configurable:!0}),e.prototype.isCrosses=function(t){var e=this;return this.someColorPoints.some(function(n){return t.points[0][0]<n[0]+e.points[0][0]&&t.points[0][1]<n[1]+e.points[0][1]&&t.points[1][0]>n[0]+e.points[0][0]&&t.points[1][1]>n[1]+e.points[0][1]})},e.prototype._checkColor=function(t,e,n){var o=this.ctx.getImageData(t,e,1,1).data;if(m.some(function(t,e){return t!==o[e]}))return!n&&this.colorPoints.find(function(n){return n[0]===t&&n[1]===e})||this.colorPoints.push([t,e,o[0],o[1]]),!0},e}(function(){function t(t){this.points=[[0,0],[0,150],[50,150],[50,0]],this.fillStyle="#ccedff",this.lineWidth=3,this.strokeStyle="#123",Object.assign(this,t),this.ctx=t.ctx}return t.prototype.draw=function(){var t=this.ctx;t.beginPath(),t.moveTo(this.points[0][0],this.points[0][1]);for(var e=1;e<this.points.length;e++)t.lineTo(this.points[e][0],this.points[e][1]);return t.closePath(),Object.assign(t,this,{points:null}),t.fill(),t.stroke(),this},t.prototype.move=function(t,e){var n=this.isOverflow(t,e);return n?this.move(n[0],n[1]):this.points.forEach(function(n){n[0]+=Math.floor(t),n[1]+=Math.floor(e)}),this},t.prototype.isOverflow=function(t,e){for(var n=this.ctx.canvas,o=0;o<this.points.length;o++){var i=this.points[o],r=i[0],s=i[1],a=r+t<0?[-r,e]:r+t>n.width?[n.width-r,e]:s+e<0?[t,-s]:s+e>n.height&&[t,n.height-s];if(a)return a}},t}()),v=function(t){function e(e){var n=t.call(this,e)||this;return n.speed=Object(h.a)(3,6),Object.assign(n,e),n.globalSpeed=e.globalSpeed,n}return Object(d.b)(e,t),e.prototype.move=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.speed);var n=this.ctx.canvas.height;return this.points[0][1]>=n&&(e=-1.5*n,this.speed=Object(h.a)(3,6)+this.globalSpeed.value),this.points.forEach(function(n){n[0]+=t,n[1]+=e}),this},e}(y),b=function(){function t(){this.value=1}return t.prototype.up=function(t){return void 0===t&&(t=.001),this.value+=t,this},t}(),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.acceleration=1,e}return Object(d.b)(e,t),e.prototype.accelerate=function(t,n){return this.getAxisSum(t,"x")||this.getAxisSum(t,"y")?this.acceleration-n.value<e.ACCELERATION_MAX&&(this.acceleration+=e.ACCELERATION_STEP):this.acceleration=1,this},e.prototype.moveByControl=function(t){return this.move(this.getAxisSum(t,"x"),this.getAxisSum(t,"y")),this},e.prototype.getAxisSum=function(t,e){var n=p("x"===e?t.right:t.down),o=p("x"===e?t.left:t.up),i=n-o;return Object.values(t).filter(Boolean).length!==n+o&&(i/=Math.SQRT2),i*this.acceleration},e.ACCELERATION_MAX=8,e.ACCELERATION_STEP=.5,e}(y),P=function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((o=o.apply(t,e||[])).next())})},x=function(t,e){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[0,i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},S=l.a.production?"/school/":"/",C=function(){function t(t,e){this.control=t,this.images=e,this.canvas={},this.ctx={},this.hero={},this.barriers=[],this.stars=[],this.gameSpeed=new b,this.score=0,this.bestScore=localStorage.getItem("game-1.best-score")||"",this.pause=!0,this.images.add("ice",S+"assets/ice.png").add("ironMan",S+"assets/iron-man.png").add("star",S+"assets/star.png")}return t.prototype.ngAfterViewInit=function(){return P(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return this.ctx=this.canvas.nativeElement.getContext("2d"),this.ctx.imageSmoothingEnabled=!0,[4,this.images.ready()];case 1:return t.sent(),this.initGame(),[2]}})})},t.prototype.onPressEnter=function(){this.control.keys.enter&&(this.pause=!this.pause,this.pause||this.startGame())},t.prototype.setPauseFalse=function(){this.pause&&(this.pause=!1,this.startGame())},t.prototype.initGame=function(){this.control.reset(),this.gameSpeed=new b,this.score=0,this.barriers=[],this.stars=[];for(var t=this.ctx,e=t.canvas,n=e.width/11,o=0;o<11;o++){var i=new v({ctx:t,image:this.images.get("ice"),globalSpeed:this.gameSpeed}),r=n*o+(n-this.images.get("ice").width)/2;i.move(r,-Object(h.a)(120,e.height)),this.barriers.push(i)}for(o=0;o<30;o++){var s=new v({ctx:t,image:this.images.get("star"),spritesCount:3,intermediate:!0,globalSpeed:this.gameSpeed}),a=-Object(h.a)(120,e.height);s.move(e.width/30*o,a),this.stars.push(s)}this.hero=new w({ctx:t,image:this.images.get("ironMan"),destroyable:!0}),this.hero.move((e.width-this.images.get("ironMan").width)/2,e.height-100).draw(),e.focus(),this.startGame()},t.prototype.startGame=function(){return P(this,void 0,void 0,function(){var t,e,n,o=this;return x(this,function(i){return this.pause?(this.drawPauseMessage(),[2]):(n=(t=this).control,this.ctx.clearRect(0,0,(e=t.ctx.canvas).width,e.height),this.score++,this.stars.forEach(function(t){o.hero.isCrosses(t)?(o.score+=200,t.move(0,e.height-t.points[0][1]).move(0,-Object(h.a)(120,e.height))):t.move().draw()}),this.hero.moveByControl(n.keys).draw(),this.barriers.forEach(function(t){return t.move().draw()}),this.hero.isDestroyed?(this.pause=!0,this.score>p(this.bestScore)&&(localStorage.setItem("game-1.best-score",this.score.toString()),this.bestScore=this.score.toString()),this.initGame(),[2]):(this.hero.accelerate(n.keys,this.gameSpeed),this.gameSpeed.up(),requestAnimationFrame(function(){return o.startGame()}),[2]))})})},t.prototype.drawPauseMessage=function(){var t="PRESS ENTER TO "+(this.score?"CONTINUE":"START"),e=this.ctx,n=e.canvas;e.clearRect(n.width-110,n.height-30,100,30),e.fillStyle="#fff",e.font="bold 70px sans-serif",e.fillText("PAUSE",n.width/2-125,n.height/2,250),e.fillStyle="#ddd",e.font="bold 32px sans-serif",e.fillText(t,n.width/2-125,n.height/2+70,250)},t}(),k=o.Ma({encapsulation:0,styles:[["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:100%}.app-iron-man__canvas[_ngcontent-%COMP%]{background-color:#272737}@media (max-width:991.98px){.app-iron-man__canvas[_ngcontent-%COMP%]{width:100%;max-height:100%}}"]],data:{}});function O(t){return o.db(0,[(t()(),o.Oa(0,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),o.cb(1,null,["The Best Score: ",""]))],null,function(t,e){t(e,1,0,e.component.bestScore)})}function E(t){return o.db(0,[o.ab(402653184,1,{canvas:0}),(t()(),o.Oa(1,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),o.cb(2,null,["Score: ",""])),(t()(),o.Oa(3,0,[[1,0],["canvas",1]],null,1,"canvas",[["appKeyboardControl",""],["class","app-iron-man__canvas"],["height","600"],["tabindex","0"],["width","800"]],null,[[null,"touchstart"],[null,"kcKeypress"],[null,"keydown"],[null,"keyup"],[null,"touchend"]],function(t,e,n){var i=!0,r=t.component;return"keydown"===e&&(i=!1!==o.Ya(t,4).onKeyboardPress(n)&&i),"keyup"===e&&(i=!1!==o.Ya(t,4).onKeyboardPress(n)&&i),"touchstart"===e&&(i=!1!==o.Ya(t,4).onTouch(n)&&i),"touchend"===e&&(i=!1!==o.Ya(t,4).controlTouchEnd()&&i),"touchstart"===e&&(i=!1!==r.setPauseFalse()&&i),"kcKeypress"===e&&(i=!1!==r.onPressEnter()&&i),i},null,null)),o.Na(4,16384,null,0,c,[a],null,{kcKeypress:"kcKeypress"}),(t()(),o.Fa(16777216,null,null,1,null,O)),o.Na(6,16384,null,0,u.i,[o.N,o.K],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,6,0,e.component.bestScore)},function(t,e){t(e,2,0,e.component.score||0)})}var T=o.Ka("app-iron-man",C,function(t){return o.db(0,[(t()(),o.Oa(0,0,null,null,1,"app-iron-man",[],null,null,null,E,k)),o.Na(1,4243456,null,0,C,[a,f],null,null)],null,null)},{},{},[]),j=n("ZYCi"),A=function(){};n.d(e,"GamesModuleNgFactory",function(){return I});var I=o.La(i,[],function(t){return o.Va([o.Wa(512,o.j,o.Aa,[[8,[T]],[3,o.j],o.v]),o.Wa(4608,u.k,u.j,[o.s,[2,u.s]]),o.Wa(4608,a,a,[]),o.Wa(4608,f,f,[]),o.Wa(1073742336,u.b,u.b,[]),o.Wa(1073742336,j.m,j.m,[[2,j.r],[2,j.k]]),o.Wa(1073742336,A,A,[]),o.Wa(1073742336,i,i,[]),o.Wa(1024,j.i,function(){return[[{path:"iron-man",component:C}]]},[])])})}}]);