webpackJsonp([0],{dHfg:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,i=n("LMZF"),r=function(){};function s(t){return Boolean(o[t])}!function(t){t[t.enter=13]="enter",t[t.left=37]="left",t[t.up=38]="up",t[t.right=39]="right",t[t.down=40]="down"}(o||(o={}));var a=function(){function t(){this.keys={}}return t.prototype.setKey=function(t,e){return s(t)&&(this.keys[o[t]]=e),this},t.prototype.reset=function(){return this.keys={},this},t}(),c=function(){function t(t){this.control=t,this.kcKeypress=new i.n}return t.prototype.onKeyboardPress=function(t){s(t.keyCode)&&(t.preventDefault(),this.kcKeypress.emit()),this.control.setKey(t.keyCode,"keyup"===t.type?0:1)},t.prototype.onTouch=function(t){var e=t.changedTouches.item(0).clientX;e>window.innerWidth/2&&(t.keyCode=o.right),e<window.innerWidth/2&&(t.keyCode=o.left),this.onKeyboardPress(t)},t.prototype.controlTouchEnd=function(t){this.control.reset()},t}(),u=n("Un6q"),l=n("p5Ee"),h=n("GNG5");function f(t){return parseInt(t,10)||0}var p=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((o=o.apply(t,e||[])).next())})},d=this&&this.__generator||function(t,e){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[0,i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},m=function(){function t(){this._collection={},this._promises=[]}return t.prototype.add=function(t,e){var n=this,o=new Image,i=new Promise(function(i,r){o.onerror=r,o.onload=function(){n._collection[t]=o,i()},o.src=e});return this._promises.push(i),this},t.prototype.get=function(t){if(!this._collection[t])throw new Error("The image "+t+" is not found in collection");return this._collection[t]},t.prototype.ready=function(){return p(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,Promise.all(this._promises)];case 1:return t.sent(),this._promises=[],[2]}})})},t}(),g=n("6Xbx"),y=[255,255,255],v=4,b=function(t){function e(e){var n=t.call(this,e)||this;n.animationFrequency=100,n.destroyable=!1,n.intermediate=!1,n.spritesCount=1,n._colorPoints=[],Object.assign(n,e);var o=n.spritesCount,i=n.image.naturalWidth,r=n.image.naturalHeight/o;if(n.points=[[0,0],[i,r]],n._spritePos=Object(h.a)(0,o-1),n.destroyable){var s=n.ctx;s.fillStyle="#fff",s.fillRect(0,0,i,r),n.draw();for(var a=0;a<i;a++)for(var c=0;c<r;c++)if(n._checkColor(a,c,!0)){for(c=r-1;c>=0&&!n._checkColor(a,c);c--);break}for(c=0;c<r;c++)for(a=0;a<i;a++)if(n._checkColor(a,c)){for(a=i-1;a>=0&&!n._checkColor(a,c);a--);break}s.clearRect(0,0,s.canvas.width,s.canvas.height),n._someColorPointsStep=Math.floor(n._colorPoints.length/v),n._someColorPointsOffset=0}return o>1&&(n.intermediate?setInterval(function(){n._spritePos+=n._spritePosFromEnd?-1:1,n._spritePos%o==0&&(n._spritePosFromEnd=!n._spritePosFromEnd,n._spritePosFromEnd&&n._spritePos--)},n.animationFrequency):setInterval(function(){n._spritePos++,n._spritePos%=o},n.animationFrequency)),n}return Object(g.b)(e,t),e.prototype.draw=function(){var t,e=[this.image.naturalWidth,this.image.naturalHeight/this.spritesCount];return(t=this.ctx).drawImage.apply(t,[this.image,0,e[1]*this._spritePos].concat(e,this.points[0],e)),this},Object.defineProperty(e.prototype,"isDestroyed",{get:function(){var t=this;return this.someColorPoints.some(function(e){var n=e[0],o=e[1],i=e.slice(2),r=t.points[0],s=t.ctx.getImageData(n+r[0],o+r[1],1,1).data;return i.some(function(t,e){return s[e]!==t})})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"someColorPoints",{get:function(){for(var t=this._colorPoints,e=[],n=this._someColorPointsOffset;n<t.length;n+=this._someColorPointsStep)e.push(t[n]);return this._someColorPointsOffset++,this._someColorPointsOffset%=this._someColorPointsStep,e},enumerable:!0,configurable:!0}),e.prototype.isCrosses=function(t){var e=this;return this.someColorPoints.some(function(n){return t.points[0][0]<n[0]+e.points[0][0]&&t.points[0][1]<n[1]+e.points[0][1]&&t.points[1][0]>n[0]+e.points[0][0]&&t.points[1][1]>n[1]+e.points[0][1]})},e.prototype._checkColor=function(t,e,n){var o=this.ctx.getImageData(t,e,1,1).data;if(y.some(function(t,e){return t!==o[e]}))return!n&&this._colorPoints.find(function(n){return n[0]===t&&n[1]===e})||this._colorPoints.push([t,e,o[0],o[1]]),!0},e}(function(){function t(t){this.points=[[0,0],[0,150],[50,150],[50,0]],this.fillStyle="#ccedff",this.lineWidth=3,this.strokeStyle="#123",Object.assign(this,t)}return t.prototype.draw=function(){var t=this.ctx;t.beginPath(),t.moveTo(this.points[0][0],this.points[0][1]);for(var e=1;e<this.points.length;e++)t.lineTo(this.points[e][0],this.points[e][1]);return t.closePath(),Object.assign(t,this,{points:null}),t.fill(),t.stroke(),this},t.prototype.move=function(t,e){var n=this.isOverflow(t,e);return n?this.move(n[0],n[1]):this.points.forEach(function(n){n[0]+=Math.floor(t),n[1]+=Math.floor(e)}),this},t.prototype.isOverflow=function(t,e){for(var n=this.ctx.canvas,o=0;o<this.points.length;o++){var i=this.points[o],r=i[0],s=i[1],a=r+t<0?[-r,e]:r+t>n.width?[n.width-r,e]:s+e<0?[t,-s]:s+e>n.height&&[t,n.height-s];if(a)return a}},t}()),_=function(t){function e(e){var n=t.call(this,e)||this;return n.speed=Object(h.a)(3,6),Object.assign(n,e),n}return Object(g.b)(e,t),e.prototype.move=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.speed);var n=this.ctx.canvas.height;return this.points[0][1]>=n&&(e=-1.5*n,this.speed=Object(h.a)(3,6)+this.globalSpeed.value),this.points.forEach(function(n){n[0]+=t,n[1]+=e}),this},e}(b),w=function(){function t(){this.value=1}return t.prototype.up=function(t){return void 0===t&&(t=.001),this.value+=t,this},t}(),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.acceleration=1,e}return Object(g.b)(e,t),e.prototype.accelerate=function(t,n){return(this._getAxisSum(t,"x")||this._getAxisSum(t,"y"))&&this.acceleration-n.value<e.ACCELERATION_MAX?this.acceleration+=e.ACCELERATION_STEP:this.acceleration=1,this},e.prototype.moveByControl=function(t){return this.move(this._getAxisSum(t,"x"),this._getAxisSum(t,"y")),this},e.prototype._getAxisSum=function(t,e){var n=f("x"===e?t.right:t.down),o=f("x"===e?t.left:t.up),i=n-o;return Object.values(t).filter(Boolean).length!==n+o&&(i/=Math.SQRT2),i*this.acceleration},e.ACCELERATION_MAX=8,e.ACCELERATION_STEP=.5,e}(b),S=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((o=o.apply(t,e||[])).next())})},x=this&&this.__generator||function(t,e){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[0,i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},k=l.a.production?"/school/":"/",C=function(){function t(t,e){this.control=t,this.images=e,this.bestScore=localStorage.getItem("game-1.best-score")||"",this.pause=!0,this.images.add("ice",k+"assets/ice.png").add("ironMan",k+"assets/iron-man.png").add("star",k+"assets/star.png")}return t.prototype.ngAfterViewInit=function(){return S(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return this.ctx=this.canvas.nativeElement.getContext("2d"),this.ctx.imageSmoothingEnabled=!0,[4,this.images.ready()];case 1:return t.sent(),this.initGame(),[2]}})})},t.prototype.onPressEnter=function(){this.control.keys.enter&&(this.pause=!this.pause,this.pause||this.startGame())},t.prototype.setPauseFalse=function(){this.pause&&(this.pause=!1,this.startGame())},t.prototype.initGame=function(){this.control.reset(),this.gameSpeed=new w,this.score=0,this.barriers=[],this.stars=[];for(var t=this.ctx,e=t.canvas,n=e.width/11,o=0;o<11;o++){var i=new _({ctx:t,image:this.images.get("ice"),globalSpeed:this.gameSpeed}),r=n*o+(n-this.images.get("ice").width)/2;i.move(r,-Object(h.a)(120,e.height)),this.barriers.push(i)}for(o=0;o<30;o++){var s=new _({ctx:t,image:this.images.get("star"),spritesCount:3,intermediate:!0,globalSpeed:this.gameSpeed}),a=-Object(h.a)(120,e.height);s.move(e.width/30*o,a),this.stars.push(s)}this.hero=new P({ctx:t,image:this.images.get("ironMan"),destroyable:!0}),this.hero.move((e.width-this.images.get("ironMan").width)/2,e.height-100).draw(),e.focus(),this.startGame()},t.prototype.startGame=function(){return S(this,void 0,void 0,function(){var t,e,n,o=this;return x(this,function(i){return this.pause?(this.drawPauseMessage(),[2]):(this.drawInterface(),e=(t=this).ctx.canvas,n=t.control,this.score++,this.stars.forEach(function(t){o.hero.isCrosses(t)?(o.score+=200,t.move(0,e.height-t.points[0][1]).move(0,-Object(h.a)(120,e.height))):t.move().draw()}),this.hero.moveByControl(n.keys).draw(),this.barriers.forEach(function(t){return t.move().draw()}),this.hero.isDestroyed?(this.pause=!0,this.score>f(this.bestScore)&&(localStorage.setItem("game-1.best-score",this.score.toString()),this.bestScore=this.score.toString()),this.initGame(),[2]):(this.hero.accelerate(n.keys,this.gameSpeed),this.gameSpeed.up(),requestAnimationFrame(function(){return o.startGame()}),[2]))})})},t.prototype.drawInterface=function(){var t=this.ctx,e=t.canvas;t.clearRect(0,0,e.width,e.height),t.fillStyle="#ddd",t.font="bold 16px sans-serif",t.fillText("PRESS ENTER TO PAUSE",e.width-110,e.height-10,100)},t.prototype.drawPauseMessage=function(){var t="PRESS ENTER TO "+(this.score?"CONTINUE":"START"),e=this.ctx,n=e.canvas;e.clearRect(n.width-110,n.height-30,100,30),e.fillStyle="#fff",e.font="bold 70px sans-serif",e.fillText("PAUSE",n.width/2-125,n.height/2,250),e.fillStyle="#ddd",e.font="bold 32px sans-serif",e.fillText(t,n.width/2-125,n.height/2+70,250)},t}(),E=i._2({encapsulation:0,styles:[[".game1-canvas[_ngcontent-%COMP%]{max-width:100%;max-height:calc(100vh - 50px);background-color:#272737}"]],data:{}});function O(t){return i._23(0,[(t()(),i._4(0,0,null,null,1,"p",[],null,null,null,null,null)),(t()(),i._22(1,null,["\n  The Best Score: ","\n"]))],null,function(t,e){t(e,1,0,e.component.bestScore)})}function T(t){return i._23(0,[i._20(402653184,1,{canvas:0}),(t()(),i._4(1,0,null,null,1,"p",[],null,null,null,null,null)),(t()(),i._22(2,null,["\n  Score: ","\n"])),(t()(),i._22(-1,null,["\n"])),(t()(),i._4(4,0,[[1,0],["canvas",1]],null,1,"canvas",[["appKeyboardControl",""],["class","game1-canvas"],["height","600"],["tabindex","0"],["width","800"]],null,[[null,"touchstart"],[null,"kcKeypress"],[null,"keydown"],[null,"keyup"],[null,"touchend"]],function(t,e,n){var o=!0,r=t.component;return"keydown"===e&&(o=!1!==i._16(t,5).onKeyboardPress(n)&&o),"keyup"===e&&(o=!1!==i._16(t,5).onKeyboardPress(n)&&o),"touchstart"===e&&(o=!1!==i._16(t,5).onTouch(n)&&o),"touchend"===e&&(o=!1!==i._16(t,5).controlTouchEnd(n)&&o),"touchstart"===e&&(o=!1!==r.setPauseFalse()&&o),"kcKeypress"===e&&(o=!1!==r.onPressEnter()&&o),o},null,null)),i._3(5,16384,null,0,c,[a],null,{kcKeypress:"kcKeypress"}),(t()(),i._22(-1,null,["\n"])),(t()(),i.Z(16777216,null,null,1,null,O)),i._3(8,16384,null,0,u.i,[i.N,i.K],{ngIf:[0,"ngIf"]},null)],function(t,e){t(e,8,0,e.component.bestScore)},function(t,e){t(e,2,0,e.component.score||0)})}var j=i._0("app-game1",C,function(t){return i._23(0,[(t()(),i._4(0,0,null,null,1,"app-game1",[],null,null,null,T,E)),i._3(1,4243456,null,0,C,[a,m],null,null)],null,null)},{},{},[]),A=n("UHIZ"),I=function(){};n.d(e,"GamesModuleNgFactory",function(){return M});var M=i._1(r,[],function(t){return i._12([i._13(512,i.j,i.X,[[8,[j]],[3,i.j],i.w]),i._13(4608,u.k,u.j,[i.t,[2,u.s]]),i._13(4608,a,a,[]),i._13(4608,m,m,[]),i._13(512,u.b,u.b,[]),i._13(512,A.m,A.m,[[2,A.r],[2,A.k]]),i._13(512,I,I,[]),i._13(512,r,r,[]),i._13(1024,A.i,function(){return[[{path:"",component:C}]]},[])])})}});